<div ng-form="vr.myForm" class="form">
	<page-menu>
		<li class="dropdown">
			<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown">Reports <b class="caret"></b></a>
			<ul class="dropdown-menu" role="menu">
				<li ng-if="vr.report.id"><a href="javascript:;" ng-click="vr.report.saveReport(false, vr.myForm, vr.report)"><i class="glyphicon glyphicon-save"></i> &nbsp; Save/View</a></li>
				<li><a href="#/reports/new"><i class="glyphicon glyphicon-plus"></i> &nbsp; New</a></li>
				<li><a href="#/reports"><i class="glyphicon glyphicon-search"></i> &nbsp; View All</a></li>
				<li ng-if="vr.report.id" class="divider"></li>
				<li ng-if="vr.report.id"><a href="javascript:;" ng-bootbox-confirm="<center><h4>Are you sure you want to delete this report?<br> All work will be permanently deleted.</h4></center>" ng-bootbox-confirm-action="vr.report.deleteReport(vr.report)"><i class="glyphicon glyphicon-trash text-danger"></i> &nbsp; Delete</a></li>
			</ul>
		</li>
		<li><a href="javascript:;" ng-click="vr.report.saveReport(true, vr.myForm, vr.report)"><span ng-class="{'save-now':vr.myForm.$dirty}">Save</span></a></li>
		<li class="dropdown">
			<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown">Options <b class="caret"></b></a>
			<ul class="dropdown-menu bump-left" role="menu">
				<li><span>Page</span></li>
				<li><span><label><input ng-model="vr.report.allow_title" type="checkbox"> Add Title</label></span></li>
				<li ng-if="vr.report.allow_title"><span><label><input ng-model="vr.report.hideTitle" type="checkbox"> Hide Title</label></span></li>
			</ul>
		</li>
		<li><a href="javascript:;" ng-click="vr.report.newPageAdd=true">Add Page</a></li>

	</page-menu>

	<div ng-if="!vr.report.templates || vr.report.newPageAdd" ng-class="{'paper-width':vr.report.id}">
		<!-- BEGIN PAGE ADD -->
		<div class="paper row">
			<div class="col-xs-12">
				<button type="button" class="close" ng-if="vr.report.newPageAdd && vr.report.templates.length" ng-click="vr.report.newPageAdd=false" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h3>Page Selection</h3>

				<ul class="list-inline">
					<li ng-repeat-start="template in vr.report.add_templates | orderBy:'id'" ng-click="vr.report.addTemplate(template, vr.myForm, vr.report);vr.report.newPageAdd=false">
						<a href="javascript:;" class="btn">{{template.name}}</a>
					</li>
					<li ng-if="!vr.report.add_templates.length" ng-repeat-end>
						<h3>Nothing here?</h3>
						<p>Make sure the Page you want to add is not marked as Draft. Uncheck the "Draft" option when editing a Page, then save it.</p>
						<p>Pages may only be added to a report once.</p>
						<button class="btn btn-primary" ng-click="vr.report.newPageAdd=false">Close</button>
					</li>
				</ul>
			</div>
		</div>
		<!-- END PAGE ADD -->
	</div>

	<template-form-directive report="vr.report" form="vr.report.form"></template-form-directive>

</div>


<!-- REPORT PAGES MOBILE BOTTOM BAR BREADCRUMBS -->
<ol ng-init="vr.report.showPages=false;vr.report.form = vr.report.templates[0]" ng-click="vr.report.showPages=!vr.report.showPages" ng-if="vr.report.templates.length" class="breadcrumb edit-report-crumbs">
	<h3>Pages</h3>
	<li ng-show="vr.report.showPages" ng-class="{'in':vr.report.showPages,'selected':template==vr.report.form}" ng-repeat="template in vr.report.templates"><a href="javascript:;" ng-click="vr.report.form = template">{{template.name}}</a></li>
</ol>
