<md-card flex ng-form="vr.repForm">
    <md-toolbar class="md-site-secondary">
        <div class="md-toolbar-tools">
            <h2>
                <span>Report</span>
            </h2>
        </div>
    </md-toolbar>

    <md-toolbar class="md-site-tertiary">
        <div class="md-toolbar-tools">
            <md-button user-menu ng-click="uv.toggleLeftMenu()" class="md-icon-button" aria-label="open options menu" ng-if="vr.report.id">
                <md-tooltip md-direction="bottom">
                    Options Menu
                </md-tooltip>
                <md-icon>menu</md-icon>
            </md-button>
            <md-button ng-click="vr.save(true)" class="md-icon-button" aria-label="save {{vr.report.title}}">
                <md-tooltip md-direction="bottom">
                    Save {{vr.report.title}}
                </md-tooltip>
                <md-icon>save</md-icon>
            </md-button>
        </div>
    </md-toolbar>

    <md-sidenav user-menu class="md-sidenav-left" md-component-id="left" ng-if="vr.report.id">
        <md-content layout="column" layout-fill layout-padding>
            <md-button clocation ng-click="lv.locate('/reports/new')" class="md-raised md-primary" aria-label="create new report">
                New Report
            </md-button>
            <md-button user-menu ng-click="vr.save()" aria-label="view {{vr.report.title}}">
                View This Report
            </md-button>
            <md-button clocation ng-click="lv.locate('/reports')" aria-label="view all reports">
                View All Reports
            </md-button>
            <span flex></span>
            <md-button ng-click="vr.delete($event, vr.report)" class="md-raised md-warn" aria-label="delete {{vr.report.name}}">
                Delete This Report
            </md-button>
        </md-content>
    </md-sidenav>

    <div layout="column" layout-padding ng-if="!vr.templates.length">
        <p>It looks like you don't have any pages yet, or they are all marked as Draft. Make sure the Page you want to add is not marked as Draft. Uncheck "Draft" when editing a Page, then save it.</p>
        <p>Pages may only be added to a report once.</p>
    </div>

    <div layout="row" layout-padding>
        <span layout="row" layout-align="center end">
            <md-button ng-click="vr.addTemplate(vr.template)" class="md-icon-button" aria-label="add {{vr.template.name}} to this report">
                <md-tooltip md-direction="bottom">
                    Add {{vr.template.name}} to this report
                </md-tooltip>
                <md-icon>add</md-icon>
            </md-button>
            <md-select ng-model="vr.template" layout-margin>
              <md-option ng-repeat="template in vr.filteredTemplates()" ng-value="template">{{template.name}}</md-option>
            </md-select>
        </span>

        <md-input-container flex ng-if="vr.report.id">
            <label>Report Name (Optional)</label>
            <input ng-model="vr.report.title" ng-keypress="($event.keyCode==13) && vr.save(true)">
        </md-input-container>
    </div>

    <div layout-padding ng-if="!vr.report.id">Pick a first Page to create this report with.</div>

    <md-tabs md-dynamic-height md-border-bottom ng-if="vr.report.templates.length">
        <md-tab label="{{template.name}}" ng-repeat="template in vr.report.templates">
            <span layout="row" layout-align="end end">
                <md-button ng-click="vr.report.form = template;vr.deleteTemplate($event)" class="md-icon-button md-warn" aria-label="remove {{template.name}} from this report">
                    <md-tooltip md-direction="bottom">
                        Remove {{template.name}} from this report
                    </md-tooltip>
                    <md-icon>clear</md-icon>
                </md-button>
            </span>
            <template-form-directive report="vr.report" form="template"></template-form-directive>
        </md-tab>
    </md-tabs>

</md-card>
