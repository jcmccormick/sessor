<h1>Template Builder</h1>
<hr>

<!-- BEGIN FORM NAME INPUT -->
<h3>Form Name
  <sup>
    <small>
      <i class="glyphicon glyphicon-flash" rel="popover" data-trigger="hover" data-content="Give your form a name to get started." data-container="body"></i>
    </small>
  </sup>
</h3>
<p ng-show="form.name == ''"></p>
<p class="has-feedback">
    <input type="text" class="form-control" ng-model="form.name" placeholder="Enter a title..." />
    <i class="glyphicon glyphicon-pencil form-control-feedback"></i>
</p>
<!-- END FORM NAME INPUT -->


<!-- BEGIN SECTION AND PREVEIW BUTTONS -->
<h3 ng-show="form.name != ''">Sections
  <sup>
    <small>
      <i class="glyphicon glyphicon-flash" rel="popover" data-trigger="hover" data-content="Add sections and preview the entire form using these buttons." data-container="body"></i>
    </small>
  </sup>
</h3>
<p class="btn-group btn-group-justified" ng-show="form.name != ''">
  <a role="button" class="btn btn-primary" data-toggle="modal" data-target=".newSectionModal">Add Section</a>
  <a role="button" class="btn btn-primary" data-toggle="modal" data-target=".previewModal" ng-click="previewUpdate()">Full Preview</a>
</p>
<!-- END SECTION AND PREVEIW BUTTONS -->


<!-- BEGIN MODALS -->


<!-- BEGIN PREVIEW MODAL -->
<div class="modal fade previewModal" tabindex="-1" role="dialog" aria-labelledby="previewModal" aria-hidden="true">
  <div class="modal-dialog modal-md">
    <form class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Template Preview</h4>
      </div>
      <div class="modal-body clearfix">
        <template-form-directive form="previewForm"></template-form-directive>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-info" data-dismiss="modal" aria-label="Return">Return</button>  
      </div>
    </form>
  </div>
</div>
<!-- END PREVIEW MODAL -->


<!-- BEGIN NEW SECTION MODAL -->
<div class="modal fade newSectionModal" tabindex="-1" role="dialog" aria-labelledby="newSectionModal" aria-hidden="true">
  <div class="modal-dialog modal-md">
    <form class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Section Design</h4>
      </div>
      <div class="modal-body">
        <div class="form-group">
            <label class="control-label">Section Title</label>
            <input type="text" class="form-control" ng-model="addSection.title" value="{{section.title}}">
        </div>
        <div class="form-group">
          <h4>Number of Columns</h4>
          <label class="btn btn-info text-center" data-dismiss="modal" aria-label="Select Columns and Create Section" ng-click="addNewSection(cols)" ng-repeat="cols in [1,2,3]">{{cols}}</label>
        </div>
      </div>
      <div class="modal-footer">
        <!-- <button type="button" class="btn btn-success" ng-click="">Create Section</button> -->  
      </div>
    </form>
  </div>
</div>
<!-- END NEW SECTION MODAL -->


<!-- END MODALS -->


<!-- START MAIN SECTION REPEATING -->
<div role="tablist" class="panel-group panel-carat" id="section-accordion">
  <div class="panel panel-info" ng-repeat="section in form.sections">


    <!-- BEGIN SECTION HEADER -->
    <div class="panel-heading template-section-header"
    ng-class="{'collapsed':!$first}"
    data-toggle="collapse" 
    data-target="#collapse{{section.id}}" 
    data-parent="#section-accordion" 
    aria-controls="collapse{{section.id}}">
      {{section.title}}
    </div>
    <!-- END SECTION HEADER -->


    <!-- BEGIN SECTION INFO PANEL -->
    <div role="tabpanel" id="collapse{{section.id}}" class="panel-collapse collapse" aria-labelledby="heading{{section.id}}-tab" ng-class="{'active in':$first}">
      <div class="panel-body" bs-popover>


        <!-- BEGIN SECTION AND COLUMN DETAILS -->
        <h3>Section Title</h3>
        <div class="input-group">
          <input type="text" class="form-control" ng-model="section.title" value="{{section.title}}">
          <span class="input-group-btn">
            <button class="btn btn-danger" ng-bootbox-confirm="<center><h2>Are you absolutely sure you want to delete this section?</h2></center>" ng-bootbox-confirm-action="deleteSection(section.id)">Delete Section</button>
          </span>
        </div>
        <hr>        
        <h3>
          Columns and Fields
          <sup>
            <small>
              <i class="glyphicon glyphicon-flash" rel="popover" data-trigger="hover" title="Columns and Fields" data-content="Multiple columns will stack on top of one another on mobile devices. Hover over the white and green icons to see details about each field type and click to add. The fields you add are different for each column." data-placement="bottom" data-container="body"></i>
            </small>
          </sup>
        </h3>
        <!-- END SECTION AND COLUMN DETAILS -->


        <!-- BEGIN COLUMN LIST -->
        <ul role="tablist" class="btn-group btn-group-justified list-unstyled">
          <li role="presentation" class="btn btn-default" ng-class="{'active in':$first}" ng-repeat="column in section.columns" aria-controls="sec{{section.id}}col{{column.id}}" data-target="#sec{{section.id}}col{{column.id}}" data-toggle="tab">
            Column {{column.id}}
          </li>
        </ul>
        <!-- END COLUMN LIST -->
        

        <!-- BEGIN COLUMN REPEATING -->
        <div class="tab-content">
          <div role="tabpanel" 
          id="sec{{section.id}}col{{column.id}}" 
          class="tab-pane fade column-preview-wrap" 
          ng-class="{'active in':$first}" 
          aria-labeledby="sec{{section.id}}col{{column.id}}-tab" 
          ng-repeat="column in section.columns">
            

            <!-- BEGIN COLUMN FIELD LIST -->
            <div id="input-fields" class="h4 text-center btn-group btn-group-justified">
              <label class="btn btn-success" ng-bootbox-prompt="Please enter a name for this {{type.value}}" ng-bootbox-prompt-action="addNewField(type.name, section.id, column.id, result)" bs-popover ng-repeat="type in addField.types">
                <i class="glyphicon {{type.glyphicon}}" id="{{type.name}}" rel="popover" data-content="{{type.value}}" data-placement="bottom" data-container="body"></i>
              </label>
            </div>
            <!-- END COLUMN FIELD LIST -->


            <!-- BEGIN FIELD REPEATING -->
            <div role="tablist" class="panel-group" id="field-accordion-{{column.id}}">
              <div class="panel panel-success" ng-repeat="field in column.fields">


                <!-- BEGIN FIELD HEADER -->
                <div class="panel-heading" 
                data-toggle="collapse" 
                data-target="#sec{{section.id}}col{{column.id}}field{{field.id}}" 
                data-parent="#field-accordion-{{column.id}}" 
                aria-controls="sec{{section.id}}col{{column.id}}field{{field.id}}" 
                id="sec{{section.id}}col{{column.id}}field{{field.title}}">
                  <h4 class="panel-title">
                    <i class="glyphicon {{field.glyphicon}}"></i>
                    {{field.title}}
                  </h4>
                </div>
                <!-- END FIELD HEADER -->


                <!-- BEGIN FIELD ACCORDION -->
                <div role="tabpanel" id="sec{{section.id}}col{{column.id}}field{{field.id}}" ng-class="{'in':$first}" class="panel-collapse collapse" aria-labelledby="sec{{section.id}}col{{column.id}}field{{field.id}}-tab">
                  <div class="panel-body">


                    <!-- BEGIN FIELD ACCORDION LEFT SIDE -->
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="control-label">Field Title</label>
                            <input type="text" class="form-control" ng-model="field.title" value="{{field.title}}">
                        </div>

                        <div class="form-group" ng-hide="field.type == 'date'">
                            <label class="control-label">Field Default Value</label>
                            <input class="form-control" type="text" ng-model="field.value" value="{{field.value}}">
                        </div>

                        <div class="form-group">
                            <label class="control-label"><input type="checkbox" ng-value="true" ng-selected ng-model="field.required"/> Required?</label>
                        </div>

                        <div class="form-group">
                            <label class="control-label"><input type="checkbox" ng-value="true" ng-selected ng-model="field.disabled"/> Disabled?</label>
                        </div>
                    </div>
                    <!-- END FIELD ACCORDION LEFT SIDE -->


                    <!-- BEGIN FIELD ACCORDION RIGHT SIDE -->
                    <div class="col-md-6">
                      <div class="form-group" ng-show="field.type == 'radio' || field.type == 'dropdown'">
                        <label class="control-label">Field Options</label>
                        <div class="control-input">
                          <button class="btn btn-primary btn-sm" type="button" ng-click="addOption(field)"> Add Option</button><br><br>
                          <p class="input-group" ng-repeat="option in field.options">
                            <input type="text" class="form-control" ng-model="option.title" value="{{option.title}}">
                            <span class="input-group-btn">
                              <button class="btn btn-danger" ng-bootbox-confirm="<center><h2>Are you absolutely sure you want to delete this option?</h2></center>" ng-bootbox-confirm-action="deleteOption(field.id, section.id, column.id, option)">
                                <i class="glyphicon glyphicon-remove"></i>
                              </button>
                            </span>
                          </p>
                        </div>
                      </div>
                    </div>
                    <!-- END FIELD ACCORDION RIGHT SIDE -->


                    <!-- BEGIN FIELD ACCORDION FOOTER -->
                    <div class="col-md-12">
                      <button type="button" class="btn btn-danger h1" ng-bootbox-confirm="<center><h2>Are you absolutely sure you want to delete this field?</h2></center>" ng-bootbox-confirm-action="deleteField(field.id, section.id, column.id)">Delete Field</button>
                    </div>
                    <!-- END FIELD ACCORDION FOOTER -->


                  </div>
                </div>
                <!-- END FIELD ACCORDION -->


              </div>
            </div>

            <!-- BEGIN COLUMN PREVIEW -->
            <div class="column-preview" id="column-preview" ng-show="column.fields.length > 0" bs-popover>
              <h4>
                Column Preview 
                <sup>
                  <small>
                    <i class="glyphicon glyphicon-flash" rel="popover" data-trigger="hover" title="Column Preview" data-content="This is a live preview of the currently selected column. Any data entered below will be used as the default value for its respective field." data-placement="bottom" data-container="body"></i>
                  </small>
                </sup>
              </h4>
              <template-field-directive ng-repeat="field in column.fields" field="field">
              </template-field-directive>
            </div>
            <!-- END COLUMN PREVIEW -->
          </div>
        </div>
        <!-- END COLUMN REPEATING -->
      </div> 
    </div>
  </div>
</div>


<div ng-show="form.sections.length > 0">
  <button type="button" class="btn btn-danger pull-right" ng-bootbox-confirm="<center><h2>Are you absolutely sure you want to delete the entire form? All work will be permanently deleted.</h2></center>" ng-bootbox-confirm-action="resetForm()">Delete Form</button>
  <a class="btn btn-small btn-primary" ng-show="!showJson" ng-click="showJson = true">Show form json object</a>
  <a class="btn btn-small btn-inverse" ng-show="showJson" ng-click="showJson = false">Hide form json object</a><br><br>
</div>

<div ng-show="showJson">
  <h4>Form object content:</h4>
  <pre>{{ form | json }}</pre>
</div>