<form name="vt.tempForm">
  <page-menu>
    <li class="dropdown">
      <a href class="dropdown-toggle" data-toggle="dropdown">Pages <b class="caret"></b></a>
      <ul class="dropdown-menu">
        <li><a href ng-click="vt.save()" ng-if="vt.template.id"><i class="glyphicon glyphicon-save"></i> &nbsp; Save/View</a></li>
        <li><a href="#/templates/new"><i class="glyphicon glyphicon-plus"></i> &nbsp; New</a></li>
        <li><a href="#/templates"><i class="glyphicon glyphicon-search"></i> &nbsp; View All</a></li>
        <li ng-if="vt.template.id" class="divider"></li>
        <li><a href ng-if="vt.template.id" ng-bootbox-confirm="<center><h4>Are you sure you want to delete this page?<br> All work will be permanently deleted.</h4></center>" ng-bootbox-confirm-action="vt.template.deleteTemplate(vt.template)"><i class="glyphicon glyphicon-trash text-danger"></i> &nbsp; Delete</a></li>
      </ul>
    </li>
    <li ng-if="vt.template.id"><a href="javascript:;" ng-click="vt.save(true)"><span ng-class="{'save-now':!vt.tempForm.$pristine}">Save</span></a></li>
    <li class="dropdown" ng-if="vt.template.id">
      <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown">Options <b class="caret"></b></a>
      <ul class="dropdown-menu bump-left">
        <li><span>Sharing</span></li>
        <li><span><label for="private_world"><input type="checkbox" id="private_world" name="private_world" ng-model="vt.template.private_world"> Share Public</label></span></li>
        <li><span><label for="private_group"><input type="checkbox" id="private_group" name="private_group" ng-model="vt.template.private_group"> Share Group</label></span></li>
        <div ng-if="vt.template.private_group == 1">
          <li class="divider"></li>
          <li><span>Group</span></li>
          <li><span><label for="group_edit"><input type="checkbox" id="group_edit" name="group_edit" ng-model="vt.template.group_edit"> Allow Editing</label></span></li>
          <div ng-if="vt.template.group_edit">
            <li><span>Editors</span></li>
            <li><span><a role="button">Add</a> / <a role="button">Remove</a></span></li>
          </div>
        </div>
      </ul>
    </li>
    <li class="dropdown" ng-if="vt.template.drafts.length">
      <a href class="dropdown-toggle" data-toggle="dropdown">Drafts <b class="caret"></b></a>
      <ul class="dropdown-menu">
        <li ng-repeat="draft in vt.template.drafts | orderBy:'time'">
          <span>
            <a href="javascript:;" ng-click="vt.template.assimilate(draft)">Draft #{{$index+1}} {{draft.recent}}</a>
          </span>
        </li>
      </ul>
    </li>
  </page-menu>

  <div class="form-header col-xs-12" ng-if="!vt.template.id || vt.template.e">
    <div class="col-xs-12" ng-if="!vt.template.id">Add a name, then press Enter</div>
    <div class="col-xs-12 col-md-3">
      <label for="form-name">Page Name</label>
      <input type="text" id="form-name" class="form-control" placeholder="Required" ng-model="vt.template.name" ng-keypress="($event.keyCode==13) && vt.save()" />
    </div>
    <div ng-if="vt.template.e">
      <div class="col-xs-6 col-md-3">
        <label for="new-section-name">New Section Name</label>
        <div class="input-group">
          <input type="text" id="new-section-name" class="form-control" placeholder="Optional" ng-model="vt.template.newSectionName" />
          <span class="input-group-btn">
            <a href="javascript:;" class="btn btn-primary" ng-click="vt.template.addSection(vt.template.newSectionName)" scroll-to=".force-hover" template="form">Add</a>
          </span>
        </div>
      </div>
      <div class="col-xs-4 col-md-2">
        <label>Draft</label>
        <span class="btn-group btn-group-justified" ng-click="vt.template.draft = !vt.template.draft">
          <a href="javascript:;" class="btn btn-default" ng-class="{'btn-primary':vt.template.draft}">On</a>
          <a href="javascript:;" class="btn btn-default" ng-class="{'btn-primary':!vt.template.draft}">Off</a>
        </span>
      </div>
      <div class="col-xs-2 col-md-1">
        <div class="input-group">
          <label>Fields</label>
          <p>{{vt.template.activeFields()}} / 20</p>
        </div>
      </div>
    </div>
  </div>

  <template-form-directive form="vt.template"></template-form-directive>
  
</form>