<md-card flex ng-form="vt.tempForm">
    <md-toolbar class="md-site-secondary">
        <div class="md-toolbar-tools">
            <h2>
                <span>Page</span>
            </h2>
        </div>
    </md-toolbar>
    <md-toolbar class="md-site-tertiary">
        <div class="md-toolbar-tools">
            <md-button user-menu ng-click="uv.toggleLeftMenu()" class="md-icon-button" aria-label="open options menu" ng-if="vt.template.id">
                <md-tooltip md-direction="bottom">
                    Options Menu
                </md-tooltip>
                <md-icon>menu</md-icon>
            </md-button>
            <md-button ng-click="vt.save(true)" class="md-icon-button" aria-label="save {{vt.template.name}}">
                <md-tooltip md-direction="bottom">
                    Save {{vt.template.name}}
                </md-tooltip>
                <md-icon ng-class="{'md-accent':!vt.tempForm.$pristine}">save</md-icon>
            </md-button>
        </div>
    </md-toolbar>

    <md-sidenav user-menu class="md-sidenav-left" md-component-id="left" ng-if="vt.template.id">
        <md-content layout="column" layout-fill layout-padding>
            <md-button clocation ng-click="lv.locate('/templates/new')" class="md-raised md-primary" aria-label="create new page">
                New Page
            </md-button>
            <md-button ng-click="vt.view_sheet($event, vt.template)" aria-label="view google sheet for {{vt.template.name}}">
                View Google Sheet
            </md-button>
            <md-button user-menu ng-click="vt.save()" aria-label="view {{vt.template.name}}">
                View This Page
            </md-button>
            <md-button clocation ng-click="lv.locate('/templates')" aria-label="view all pages">
                View All Pages
            </md-button>
            <md-divider></md-divider>
            <md-checkbox ng-model="vt.template.private_world" aria-label="toggle public sharing">
                Share Publically
            </md-checkbox>
            <md-checkbox ng-model="vt.template.private_group" aria-label="toggle group sharing">
                Share within Group
            </md-checkbox>
            <md-checkbox ng-model="vt.template.group_edit" aria-label="toggle allowing group editors">
                Allow Group Editors
            </md-checkbox>
            <span flex></span>
            <md-button ng-click="vt.delete($event, vt.template)" class="md-raised md-warn" aria-label="delete {{vt.template.name}}">
                Delete This Page
            </md-button>
        </md-content>
    </md-sidenav>

    <div layout-padding layout-margin ng-if="!vt.template.id">Enter a name for your Page and press Enter or Save</div>

    <div layout="row" layout-align="start end" layout-margin>
        <md-input-container flex class="md-no-errors">
            <label>(Required) Page Name</label>
            <input ng-model="vt.template.name" ng-keypress="($event.keyCode==13) && vt.save(true)">
        </md-input-container>
        <div layout="column" layout-align="end end" ng-if="vt.template.id">
            {{vt.template.fields.length || 0}} of 20 fields used
            <md-checkbox ng-model="vt.template.draft" class="md-no-checkbox-margin" aria-label="{{vt.template.name}} toggle draft">
                Draft
            </md-checkbox>
        </div>
    </div>

    <draggable-options field="vt.template.sO" form="vt.template" class="field-options" ng-if="vt.template.poppedOut && vt.template.sO.o"></draggable-options>

    <template-form-directive form="vt.template"></template-form-directive>

    <md-button ng-click="vt.template.addSection(form)" aria-label="add a new section" ng-if="vt.template.id && ((vt.template.fields && vt.template.fields.length) || 0) < 20">
        <md-icon>add</md-icon> Add Section
    </md-button>
    
</md-card>